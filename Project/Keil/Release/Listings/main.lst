C51 COMPILER V9.60.7.0   MAIN                                                              09/08/2025 09:17:19 PAGE 1   


C51 COMPILER V9.60.7.0, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN .\Release\Objects\main.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE ..\..\User\main.c LARGE OPTIMIZE(8,SPEED) BROWSE INTVECTOR(0X000C) INCDI
                    -R(..\..\Libraries\Include;..\..\User) INTERVAL(3) DEBUG OBJECTEXTEND PRINT(.\Release\Listings\main.lst) OBJECT(.\Release
                    -\Objects\main.obj)

line level    source

   1          
   2          
   3          #include "include.h"
   4          #include <stdio.h>
   5          #include "main.h"
   6          #include <math.h>
   7          /** @addtogroup Template_Project
   8           * @{
   9           */
  10          
  11          /* Private typedef -----------------------------------------------------------*/
  12          /* Private define ------------------------------------------------------------*/
  13          /* Private macro -------------------------------------------------------------*/
  14          /* Private variables ---------------------------------------------------------*/
  15          
  16          LED_S led_state;
  17          /* Private function prototypes -----------------------------------------------*/
  18          /* Private functions ---------------------------------------------------------*/
  19          
  20          /*********************************
  21          |--------------------------------|
  22          | ä½¿ç”¨%dæ‰“å°çš„æ•°å€¼ä¸å¯¹æ—¶ï¼Œè¯·æ³¨æ„ |
  23          |--------------------------------|
  24          | æ ¼å¼ |     å«ä¹‰     | é’ˆå¯¹ç±»å‹ |
  25          |------|--------------|----------|
  26          | %bd  | å•ä¸ªå­—èŠ‚å˜é‡ | char     |
  27          | % d  | ä¸¤ä¸ªå­—èŠ‚å˜é‡ | int      |
  28          | %ld  | å››ä¸ªå­—èŠ‚å˜é‡ | long int |
  29          |--------------------------------|
  30          **********************************/
  31          // é‡å†™puchar()å‡½æ•°,ç”¨äºæ ‡å‡†printf()å‡½æ•° (æ³¨æ„:ä½¿ç”¨printf()å‡½æ•°å ç”¨1kå·¦å³çš„codeç©ºé—´
             -)
  32          char putchar(char c)
  33          {
  34   1          debug_putchar(c);
  35   1      
  36   1          return c;
  37   1      }
  38          
  39          /**
  40           * @brief  Main program.
  41           * @param  None
  42           * @retval None
  43           */
  44          extern void timer4_cap_init(void);
  45          extern void timer0_init();
  46          extern void get_duty(void);
  47          extern void pwm_init(void);
  48          extern void option_fun(void);
  49          extern void init_lvd_4V(void);
  50          extern void init_lvd_3v(void);
  51          
  52          extern void lvd_handler(void);
C51 COMPILER V9.60.7.0   MAIN                                                              09/08/2025 09:17:19 PAGE 2   

  53          extern void adc_init();
  54          extern void adc_val();
  55          extern u16 ntc_val;
  56          extern u16 adjust_val;
  57          extern u16 ajust_duty;
  58          extern u16 adc0_val;
  59          extern u16 adc1_val;
  60          extern void adjust_pwm();
  61          extern u16 max_duty;
  62          extern u32 pwm_in_duty;
  63          extern bit dly_pwr_on;
  64          extern u8 simple_over;
  65          extern u16 max_duty;
  66          void main(void)
  67          {
  68   1      
  69   1          system_init();
  70   1      
  71   1          //  P1_MD1   &= ~GPIO_P15_MODE_SEL(0x03);
  72   1          //  P1_MD1   |=  GPIO_P15_MODE_SEL(0x01);
  73   1          //  P1_PU |= GPIO_P15_PULL_UP(1);
  74   1          //  P15 = 1;
  75   1      
  76   1          //  P1_MD1   &= ~GPIO_P16_MODE_SEL(0x03);
  77   1          //  P1_MD1   |=  GPIO_P16_MODE_SEL(0x01);
  78   1          //  P1_PU |= GPIO_P16_PULL_UP(1);
  79   1          //  P16 = 1;
  80   1          //          while(1)
  81   1          //    {
  82   1          //      WDT_KEY = WDT_KEY_VAL(0xAA);        // å–‚ç‹—å¹¶æ¸…é™¤ wdt_pending
  83   1          //          }
  84   1      
  85   1          //  delay_ms(5);
  86   1      #if 1
  87   1          // çœ‹é—¨ç‹—é»˜è®¤æ‰“å¼€, å¤ä½æ—¶é—´2s
  88   1          //    WDT_KEY = WDT_KEY_VAL(0xDD);               //  å…³é—­çœ‹é—¨ç‹— (å¦‚éœ€é…ç½®çœ‹é—¨ç‹—è¯·æŸ¥çœ‹â€
             -œWDT\WDT_Resetâ€ç¤ºä¾‹)
  89   1          led_state = LED_PWR_ON;
  90   1      
  91   1          delay_ms(10);
  92   1          // åˆå§‹åŒ–æ‰“å°
  93   1          debug_init();
  94   1          user_printf("TX8C126x_SDK main start\n");
  95   1          timer4_cap_init();
  96   1      
  97   1          __SetIRQnIP(TMR4_IRQn, TMR4_IQn_CFG);
  98   1          __SetIRQnIP(STMR0_IRQn, STMR0_IQn_CFG);
  99   1      
 100   1          timer0_init();
 101   1          pwm_init();
 102   1          adc_init();
 103   1          adc_val(); // åˆå§‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡ï¼Œç”¨äºæ ‡å¿—ä½åˆ¤æ–­
 104   1          option_fun();
 105   1          printf("adc0_val = %d  adc1_val = %d \r\n ", adc0_val, adc1_val);
 106   1          init_lvd_3v();
 107   1          while (1)
 108   1          {
 109   2              WDT_KEY = WDT_KEY_VAL(0xAA); // å–‚ç‹—å¹¶æ¸…é™¤ wdt_pending
 110   2              get_duty();
 111   2              lvd_handler();
 112   2              // adc_val();//adcå€¼
 113   2              adjust_pwm(); // ç”µä½å™¨å€¼
C51 COMPILER V9.60.7.0   MAIN                                                              09/08/2025 09:17:19 PAGE 3   

 114   2                            // dly_pwr_on =1;
 115   2          }
 116   1      #endif
 117   1      }
 118          
 119          /**
 120           * @}
 121           */
 122          
 123          /*************************** (C) COPYRIGHT 2021 HUGE-IC ***** END OF FILE *****/


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    132    ----
   CONSTANT SIZE    =     58    ----
   XDATA SIZE       =      1       1
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
